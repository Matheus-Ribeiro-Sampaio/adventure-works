-- models/intermediate/order/int_sales_reason.sql

WITH SALES_REASON AS (
    SELECT 
        SALES_ORDER_REASON.SALESORDERID,
        SALES_ORDER_REASON.SALESREASONID, 
        CAST(SALES_REASON.NAME AS VARCHAR(50)) AS NAME, 
        CAST(SALES_REASON.REASONTYPE AS VARCHAR(50)) AS REASONTYPE, 
        CAST(SALES_REASON.MODIFIEDDATE AS DATE) AS MODIFIEDDATE
    FROM 
        {{ ref('stg_adventure_works__salesreason') }} AS SALES_REASON
    INNER JOIN {{ ref('stg_adventure_works__salesorderheadersalesreason') }} SALES_ORDER_REASON
        ON SALES_ORDER_REASON.SALESREASONID = SALES_REASON.SALESREASONID
)

SELECT * FROM SALES_REASON