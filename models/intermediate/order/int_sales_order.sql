-- models/intermediate/order/int_sales_order.sql

WITH SALES_ORDER AS (
    SELECT 
        SALESORDERID, 
        REVISIONNUMBER, 
        CAST(ORDERDATE AS DATE) AS ORDERDATE, 
        CAST(DUEDATE AS DATE) AS DUEDATE, 
        CAST(SHIPDATE AS DATE) AS SHIPDATE,
        STATUS AS STATUSID, 
        ONLINEORDERFLAG, 
        CAST(PURCHASEORDERNUMBER AS VARCHAR(15)) AS PURCHASEORDERNUMBER, 
        CAST(ACCOUNTNUMBER AS VARCHAR(15)) AS ACCOUNTNUMBER, 
        CUSTOMERID, 
        SALESPERSONID, 
        TERRITORYID, 
        BILLTOADDRESSID, 
        SHIPTOADDRESSID, 
        SHIPMETHODID, 
        CREDITCARDID, 
        CAST(CREDITCARDAPPROVALCODE AS VARCHAR(17)) AS CREDITCARDAPPROVALCODE, 
        CURRENCYRATEID, 
        SUBTOTAL, 
        TAXAMT, 
        FREIGHT, 
        TOTALDUE, 
        -- COMMENT, --CAMPO DESCARTADO, SOMENTE CONTÃ‰M VALORES NULOS 
        CAST(ROWGUID AS VARCHAR(38)) AS ROWGUID, 
        CAST(MODIFIEDDATE AS DATE) AS MODIFIEDDATE  
    FROM 
        {{ ref('stg_adventure_works__salesorderheader') }}
)

SELECT * FROM SALES_ORDER