-- models/intermediate/person/int_person.sql

WITH PERSON AS (
    SELECT 
        BUSINESSENTITYID AS PERSONID, 
        CAST(PERSONTYPE AS VARCHAR(4)) AS PERSONTYPE, 
        --NAMESTYLE, --CAMPO DESCARTADO, SOMENTE CONTÉM O VALOR "FALSE"  
        CAST(TITLE AS VARCHAR(6)) AS TITLE, 
        CAST(CONCAT(FIRSTNAME, ' ', LASTNAME) AS VARCHAR(150)) AS NAME,
        --FIRSTNAME, -- CAMPO JÁ ESTÁ SENDO UTILIZADO/TRATADO
        --MIDDLENAME, -- CAMPO NÃO SERÁ UTILIZADO
        --LASTNAME, -- CAMPO JÁ ESTÁ SENDO UTILIZADO/TRATADO
        CAST(SUFFIX AS VARCHAR(5)) AS SUFFIX, 
        EMAILPROMOTION, 
        --ADDITIONALCONTACTINFO, --CAMPO DESCARTADO, SOMENTE CONTÉM O VALOR "[NULL]" 
        CAST(DEMOGRAPHICS AS VARCHAR(1000)) AS DEMOGRAPHICS, 
        CAST(ROWGUID AS VARCHAR(38)) AS ROWGUID, 
        CAST(MODIFIEDDATE AS DATE) AS MODIFIEDDATE 
    FROM 
        {{ ref('stg_adventure_works__person') }}
)

SELECT * FROM PERSON